{% load static %}

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ImpoVinos - Inventario</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
  <div class="site">
    
     {% include 'misc/navbar.html' %} 

    <section class="section-p1">
      <h2>Gestión de Inventario</h2>

    <form class="form-inventario" method="post">
      {% csrf_token %}
      <label for="producto">Nombre del Producto:</label>
      <input type="text" id="producto" name="producto" required>

      <label for="categoria">Categoría:</label>
      <select id="categoria" name="categoria" required>
        {% for cat in categorias %}
          <option value="{{ cat.id }}">{{ cat.nombre }}</option>
        {% endfor %}
      </select>

      <label for="cantidad">Cantidad:</label>
      <input type="number" id="cantidad" name="cantidad" min="1" required>

      <label for="precio">Precio (CLP):</label>
      <input type="number" id="precio" name="precio" min="0" required>

      <label for="pais">País de Origen:</label>
      <input type="text" id="pais" name="pais">

      <label for="anio">Año:</label>
      <input type="number" id="anio" name="anio">

      <button type="submit" name="agregar">Registrar Producto</button>
    </form>

      <h3>Vinos en Inventario</h3>
      <table class="inventario-table">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Categoría</th>
            <th>Stock</th>
            <th>Precio</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for vino in vinos %}
          <tr>
            <td>{{ vino.nombre }} - {{ vino.pais_origen }}</td>
            <td>{{ vino.categoria.nombre }}</td>
            <td>{{ vino.stock }}</td>
            <td>${{ vino.precio }}</td>
            <td>
              <!-- Form para borrar -->
              <form method="post" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="vino_id" value="{{ vino.id }}">
                <input type="number" name="cantidad" min="1" max="{{ vino.stock }}" placeholder="Cantidad">
                <button type="submit" name="eliminar">Eliminar</button>
                <small>(dejar vacío para eliminar todo)</small>
              </form>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5">No hay vinos en el inventario.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
    <p>Total vinos en base: {{ vinos.count }}</p>
    <footer>
      <div class="footer">
        <p>© Todos los derechos reservados, Grupo 10 Semana 6</p>
      </div>
    </footer>
  </div>
</body>
</html>